/*
    *
    * Wijmo Library 5.20171.282
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';var r=function(){function i(){}return i.save=function(n,t,i){var r=this._saveFlexGridToWorkbook(n,t);return i&&r.save(i),r},i.saveAsync=function(n,t,i,r,u){var f=this._saveFlexGridToWorkbook(n,t);return f.saveAsync(i,r,u),f},i.load=function(t,i,r){var e=this,u,f;if(i instanceof Blob)u=new FileReader,u.onload=function(){var f=n.xlsx.Workbook._base64EncArr(new Uint8Array(u.result)),i=new n.xlsx.Workbook;i.load(f);e._loadToFlexGrid(t,i,r)},u.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)this._loadToFlexGrid(t,i,r);else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';f=new n.xlsx.Workbook;f.load(i);this._loadToFlexGrid(t,f,r)}},i.loadAsync=function(t,i,r,u,f){var o=this,e,s;if(i instanceof Blob)e=new FileReader,e.onload=function(){var i=n.xlsx.Workbook._base64EncArr(new Uint8Array(e.result)),s=new n.xlsx.Workbook;s.loadAsync(i,function(n){o._loadToFlexGrid(t,n,r);u&&u(n)},f)},e.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)this._loadToFlexGrid(t,i,r),u&&u(i);else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';s=new n.xlsx.Workbook;s.loadAsync(i,function(n){o._loadToFlexGrid(t,n,r);u&&u(n)},f)}},i._saveFlexGridToWorkbook=function(i,r){var g=new n.xlsx.Workbook,h=new n.xlsx.WorkSheet,nt=new n.xlsx.WorkbookFrozenPane,ut=r&&r.includeColumnHeaders!=null?r.includeColumnHeaders:!0,d=r&&r.includeRowHeaders!=null?r.includeRowHeaders:!1,p=r&&r.includeCellStyles!=null?r.includeCellStyles:!0,ot=r?r.activeWorksheet:null,c=r?r.includeColumns:null,e,a,w,v,y,o,u,f,tt,l,k,ft,b,it=0,rt=0,et=0,s=0;if(tt=i.wj_sheetInfo,h.name=r?r.sheetName:'',h.visible=r?r.sheetVisible!==!1:!0,o=[],!tt&&p&&(l=document.createElement('div'),l.style.visibility='hidden',i.hostElement.appendChild(l)),d){for(u=0;u<i.rowHeaders.rows.length;u++)for(o[u]=[],f=0;f<i.rowHeaders.columns.length;f++)w=i._getBindingColumn(i.rowHeaders,u,i.rowHeaders.columns[f]),v=this._getColumnSetting(w,i.columnHeaders.columns.defaultSize),o[u][f]=v,u===0&&(y=new n.xlsx.WorkbookColumn,y._deserialize(v),h._addWorkbookColumn(y,f));s=f}if(ut&&i.columnHeaders.rows.length>0){for(u=0;u<i.columnHeaders.rows.length;u++){for(o[u]||(o[u]=[]),f=0;f<i.columnHeaders.columns.length;f++)w=i._getBindingColumn(i.columnHeaders,u,i.columnHeaders.columns[f]),v=this._getColumnSetting(w,i.columnHeaders.columns.defaultSize),o[u][s+f]=v,u===0&&(!c||c(w))&&(y=new n.xlsx.WorkbookColumn,y._deserialize(v),h._addWorkbookColumn(y));s=0;e={};a=new n.xlsx.WorkbookRow;d&&(s=this._parseFlexGridRowToSheetRow(i.topLeftCells,e,u,0,o,p,l,!1,0,c));this._parseFlexGridRowToSheetRow(i.columnHeaders,e,u,s,o,p,l,!1,0,c);e.cells.length>0&&(a._deserialize(e),h._addWorkbookRow(a,u))}rt=u}else for(o[0]||(o[0]=[]),f=0;f<i.columnHeaders.columns.length;f++)w=i._getBindingColumn(i.columnHeaders,0,i.columnHeaders.columns[f]),v=this._getColumnSetting(w,i.columnHeaders.columns.defaultSize),o[0][s+f]=v,(!c||c(w))&&(y=new n.xlsx.WorkbookColumn,y._deserialize(v),h._addWorkbookColumn(y));for(u=0;u<i.cells.rows.length;u++)(s=0,e={},a=new n.xlsx.WorkbookRow,k=i.rows[u],k instanceof t._NewRowTemplate)||(b=k instanceof t.GroupRow,b&&(ft=n.tryCast(k,t.GroupRow),it=ft.level+1),d&&(s=this._parseFlexGridRowToSheetRow(i.rowHeaders,e,u,0,o,p,l,b,it,c)),this._parseFlexGridRowToSheetRow(i.cells,e,u,s,o,p,l,b,it,c),e.cells.length>0&&(a._deserialize(e),h._addWorkbookRow(a,rt+u)));for(et=i.cells.rows.length,u=0;u<i.columnFooters.rows.length;u++)s=0,e={},a=new n.xlsx.WorkbookRow,k=i.columnFooters.rows[u],b=k instanceof t.GroupRow,d&&(s=this._parseFlexGridRowToSheetRow(i.rowHeaders,e,u,0,o,p,l,b,0,c)),this._parseFlexGridRowToSheetRow(i.columnFooters,e,u,s,o,p,l,b,0,c),e.cells.length>0&&(a._deserialize(e),h._addWorkbookRow(a,rt+et+u));return nt.rows=ut?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,nt.columns=d?i.frozenColumns+i.rowHeaders.columns.length:i.frozenColumns,h.frozenPane=nt,g._addWorkSheet(h),!tt&&p&&i.hostElement.removeChild(l),g.activeWorksheet=ot,g},i._loadToFlexGrid=function(i,r,u){var ii=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,y=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,yt=u&&u.sheetIndex!=null&&!isNaN(u.sheetIndex)?u.sheetIndex:0,ri=u?u.sheetName:null,ui=u?u.sheetVisible:!0,fi=u&&(u.sheetIndex!=null&&!isNaN(u.sheetIndex)||u.sheetName!=null||u.sheetVisible!=null),f=0,s=0,nt,tt,a,it,w,p,rt,pt,d,dt,o,c,gt,b,ut,h,ft,et,ni,wt,l,ot,k,v,st,e,bt,kt,ht,ct,ti,g,lt=!1,at={},vt;if(i.itemsSource=null,i.columns.clear(),i.rows.clear(),i.frozenColumns=0,i.frozenRows=0,bt={},kt={},s=0,it=[],ht=[],yt<0||yt>=r.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(c=r.sheets[yt],c.rows!=null){for(ii&&(s=1,c.rows.length<=1&&(y=!1,s=0),pt=c.rows[0]),b=this._getColumnCount(c.rows),gt=this._getRowCount(c.rows,b),ni=c.summaryBelow,a=c.columns,f=0;f<b;f++)i.columns.push(new t.Column),!a[f]||(isNaN(+a[f].width)||(i.columns[f].width=+a[f].width),a[f].visible||a[f].visible==undefined||(i.columns[f].visible=!!a[f].visible),a[f].style&&!!a[f].style.wordWrap&&(i.columns[f].wordWrap=a[f].style.wordWrap));for(;s<gt;s++){if(ut=!1,vt=!0,o=c.rows[s],o)for(ft=s+1;ft<c.rows.length;)if(et=c.rows[ft],et){(isNaN(o.groupLevel)&&!isNaN(et.groupLevel)||!isNaN(o.groupLevel)&&o.groupLevel<et.groupLevel)&&(ut=!0);break}else ft++;for(ut&&!ni?(l&&(l.isCollapsed=lt),l=new t.GroupRow,l.isReadOnly=!1,lt=o.collapsed==null?!1:o.collapsed,l.level=isNaN(o.groupLevel)?0:o.groupLevel,at[l.level]=lt,this._checkParentCollapsed(at,l.level)&&l._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(l)):(wt=new t.Row,o&&this._checkParentCollapsed(at,o.groupLevel)&&wt._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(wt)),!o||!o.height||isNaN(o.height)||(i.rows[y?s-1:s].height=o.height),f=0;f<b;f++)if(o){if(h=o.cells[f],v=h?h.formula:undefined,v&&v[0]!=='='&&(v='='+v),v=v?this._parseToFlexSheetFormula(v):undefined,i.setCellData(y?s-1:s,f,v&&fi?v:this._getItemValue(h)),ut||this._setColumn(it,f,h),st=s*b+f,e=h?h.style:undefined,ct=n.xlsx.Workbook._parseExcelFormat(h),e){if(vt=vt&&!!e.wordWrap,ti=this._getItemType(h),e.hAlign)g=n.xlsx.Workbook._parseHAlignToString(n.asEnum(e.hAlign,n.xlsx.HAlign));else switch(ti){case n.DataType.Number:g='right';break;case n.DataType.Boolean:g='center';break;default:g=ct&&ct.search(/[n,c,p]/i)===0?'right':'left'}bt[st]={fontWeight:e.font&&e.font.bold?'bold':'none',fontStyle:e.font&&e.font.italic?'italic':'none',textDecoration:e.font&&e.font.underline?'underline':'none',textAlign:g,fontFamily:e.font&&e.font.family?e.font.family:'',fontSize:e.font&&e.font.size?e.font.size+'px':'',color:e.font&&e.font.color?e.font.color:'',backgroundColor:e.fill&&e.fill.color?e.fill.color:'',whiteSpace:e.wordWrap?'pre-wrap':'normal',format:ct};e.font&&ht.indexOf(e.font.family)===-1&&ht.push(e.font.family)}if(h&&n.isNumber(h.rowSpan)&&h.rowSpan>0&&n.isNumber(h.colSpan)&&h.colSpan>0&&(h.rowSpan>1||h.colSpan>1))for(nt=s;nt<s+h.rowSpan;nt++)for(tt=f;tt<f+h.colSpan;tt++)st=nt*b+tt,kt[st]=new t.CellRange(s,f,s+h.rowSpan-1,f+h.colSpan-1)}else i.setCellData(y?s-1:s,f,''),this._setColumn(it,f,undefined);o&&(this._checkParentCollapsed(at,o.groupLevel)||o.visible||o.visible==undefined||(i.rows[y?s-1:s].visible=o.visible),i.rows[y?s-1:s].wordWrap=!!o.style&&!!o.style.wordWrap||vt)}for(l&&(l.isCollapsed=lt),c.frozenPane&&(ot=c.frozenPane.columns,n.isNumber(ot)&&!isNaN(ot)&&(i.frozenColumns=ot),k=c.frozenPane.rows,n.isNumber(k)&&!isNaN(k)&&(i.frozenRows=y&&k>0?k-1:k)),f=0;f<i.columnHeaders.columns.length;f++)w=it[f],p=i.columns[f],p.isRequired=!1,y?(d=pt?pt.cells[f]:undefined,d&&d.value?(dt=n.xlsx.Workbook._parseExcelFormat(d),rt=n.Globalize.format(d.value,dt)):rt=this._numAlpha(f)):rt=this._numAlpha(f),p.header=rt,w&&(w.dataType===n.DataType.Boolean&&(p.dataType=w.dataType),p.format=w.format,p.align=w.hAlign,p.wordWrap=p.wordWrap||w.wordWrap);i.wj_sheetInfo={name:ri||c.name,visible:ui===!0?!0:c.visible!==!1,styledCells:bt,mergedRanges:kt,fonts:ht}}},i._parseFlexGridRowToSheetRow=function(t,i,r,u,f,e,o,s,h,c){var b,v,nt,a,y,l,k,g,rt,tt,ot,w,d,ft,et,ut,p,ht=!1,st,it,ct;for(b=t.grid,ut=b.wj_sheetInfo,v=t.rows[r],ct=v.recordIndex!=null?v.recordIndex:0,i.cells||(i.cells=[]),i.visible=v.isVisible,i.height=v.renderHeight||t.rows.defaultSize,i.groupLevel=s?h-1:h,s&&(i.collapsed=v.isCollapsed),v.wordWrap&&(i.style={wordWrap:v.wordWrap}),(v.constructor===n.grid.Row||v.constructor===n.grid._NewRowTemplate||n.grid.detail&&v.constructor===n.grid.detail.DetailRow||n.grid.multirow&&v.constructor===n.grid.multirow._MultiRow)&&(ht=!0),a=0;a<t.columns.length;a++)if(et=1,ft=1,it=!1,st=b._getBindingColumn(t,r,t.columns[a]),d=null,ut&&t===b.cells?(ot=r*t.columns.length+a,ut.mergedRanges&&(d=ut.mergedRanges[ot]),ut.styledCells&&(w=ut.styledCells[ot])):e&&(w=this._getCellStyle(t,o,r,a)||{}),d||(d=b.getMergedRange(t,r,a,!1)),d?r===d.topRow&&a===d.leftCol&&(ft=d.bottomRow-d.topRow+1,et=this._getColSpan(t,d,c),it=!0):it=!0,!c||c(st))if(nt=f[ct][a+u],ht||s?(l=it?t.getCellData(r,a,!0):null,k=it?t.getCellData(r,a,!1):null,rt=!1,l&&n.isString(l)&&l.length>1&&l[0]==='='&&(rt=!0),p=n.isDate(k),y=w&&w.format?n.xlsx.Workbook._parseCellFormat(w.format,p):nt&&nt.style&&nt.style.format?n.xlsx.Workbook._parseCellFormat(nt.style.format,p):null,y||(p?y='m/d/yyyy':n.isNumber(k)&&!st.dataMap?y=n.isInt(k)?'#,##0':'#,##0.00':rt?(tt=l.toLowerCase(),tt==='=now()'?(y='m/d/yyyy h:mm',p=!0):tt==='=today()'||tt.substring(0,tt.indexOf('('))==='=date'?(y='m/d/yyyy',p=!0):tt.substring(0,tt.indexOf('('))==='=time'&&(y='h:mm AM/PM',p=!0)):y='General')):(l=it?b.columnHeaders.getCellData(0,a,!0):null,y='General'),t===b.cells&&s&&v.hasChildren&&a===b.columns.firstVisibleIndex){if(l?g=l:it&&(g=v.getGroupHeader().replace(/<\/?\w+>/g,'')),g==null&&!w)continue;p=n.isDate(g);g=typeof g=='string'?n.xlsx.Workbook._unescapeXML(g):g;i.cells.push({value:g,isDate:p,formula:rt?this._parseToExcelFormula(l,p):null,colSpan:et,rowSpan:ft,style:this._extend(this._parseCellStyle(w),{format:y,font:{bold:!0},hAlign:n.xlsx.HAlign.Left,indent:h-1})})}else l=typeof l=='string'?n.xlsx.Workbook._unescapeXML(l):l,k=typeof k=='string'?n.xlsx.Workbook._unescapeXML(k):k,i.cells.push({value:rt?undefined:y==='General'?l:k,isDate:p,formula:rt?this._parseToExcelFormula(l,p):null,colSpan:a<b.columns.firstVisibleIndex?1:et,rowSpan:ft,style:this._extend(this._parseCellStyle(w),{format:y,hAlign:w&&w.textAlign?n.xlsx.Workbook._parseStringToHAlign(w.textAlign):n.isDate(k)&&nt.style.hAlign==null?n.xlsx.HAlign.Left:n.asEnum(nt.style.hAlign,n.xlsx.HAlign,!0),vAlign:ft>1?t===b.cells?n.xlsx.VAlign.Top:n.xlsx.VAlign.Center:null})});return u+a},i._parseCellStyle=function(t){var i=t&&t.fontSize?+t.fontSize.substring(0,t.fontSize.indexOf('px')):null;return isNaN(i)&&(i=null),{font:{bold:t&&t.fontWeight&&(t.fontWeight==='bold'||!isNaN(+t.fontWeight)&&+t.fontWeight>=700),italic:t&&t.fontStyle&&t.fontStyle==='italic',underline:t&&t.textDecoration&&t.textDecoration==='underline',family:t?this._parseToExcelFontFamily(t.fontFamily):null,size:i,color:t&&t.color?t.color:null},fill:{color:t&&t.backgroundColor?t.backgroundColor:null},borders:t?this._parseBorder(t):null,hAlign:t&&t.textAlign?n.xlsx.Workbook._parseStringToHAlign(t.textAlign):null,wordWrap:t&&t.whiteSpace?t.whiteSpace.indexOf('pre')>-1?!0:!1:!1}},i._parseBorder=function(n){var t,i;for(var r in{Left:0,Right:0,Top:0,Bottom:0})i=this._parseEgdeBorder(n,r),i&&(t||(t={}),t[r.toLowerCase()]=i);return t},i._parseEgdeBorder=function(t,i){var r,f='border'+i+'Color',u=t['border'+i+'Style'],e;if(u&&u!=='none'&&u!=='hidden'){r={};u=u.toLowerCase();switch(u){case'dotted':r.style=n.xlsx.BorderStyle.Dotted;break;case'dashed':r.style=n.xlsx.BorderStyle.Dashed;break;case'double':r.style=n.xlsx.BorderStyle.Double;break;default:r.style=n.xlsx.BorderStyle.Thin}t[f]&&(e=new n.Color(t[f]),r.color=e.toString())}return r},i._parseToExcelFontFamily=function(n){var t;return n&&(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))),n},i._parseToExcelFormula=function(t,i){var f=t.substring(1,t.indexOf('(')).toLowerCase(),r,u;switch(f){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(')'))+', 1)';break;case'text':u=t.search(/\,\s*\"/);r=t.substring(u,t.lastIndexOf('\"'));r=n.xlsx.Workbook._parseCellFormat(r.substring(r.lastIndexOf('\"')+1),i);t=t.substring(0,u)+', \"'+r+'\")'}return t},i._parseToFlexSheetFormula=function(t){var f=t.substring(1).match(/\W+(\w+)\(/),r,e,o,s,i,u;e=f&&f.length===2?f[1]:t.substring(1,t.indexOf('('));o=t.indexOf(e);switch(e.toLowerCase()){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(','))+')';break;case'text':r=t.substring(o);i=r.substring(r.indexOf('\"'),r.lastIndexOf('\"'));i=i.substring(i.lastIndexOf('\"')+1);s=i.indexOf('0')>-1?0:'';u=n.xlsx.Workbook._parseExcelFormat({value:s,style:{format:i}});u=u.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});t=t.substring(0,o)+r.substring(0,r.indexOf('\"')+1)+u+t.substring(t.indexOf(i)+i.length)}return t},i._getColumnSetting=function(t,i){var r=t.renderWidth;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.Workbook._parseCellFormat(t.format,t.dataType===n.DataType.Date):'',hAlign:n.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(t.getAlignment())),wordWrap:t.wordWrap}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(t){for(var f=0,i=0,r,u=0;u<t.length;u++)r=t[u]&&t[u].cells?t[u].cells:[],r&&r.length>0&&(i=r.length,n.isInt(r[i-1].colSpan)&&r[i-1].colSpan>1&&(i=i+r[i-1].colSpan-1),i>f&&(f=i));return f},i._getRowCount=function(t,i){for(var f=t.length,u=f-1,o=0,e,s,r;o<i;o++)n:for(;u>=0;u--)if(e=t[u],s=e&&e.cells?e.cells:[],r=s[o],r&&(r.value!=null&&r.value!==''||n.isInt(r.rowSpan)&&r.rowSpan>1)){n.isInt(r.rowSpan)&&r.rowSpan>1&&u+r.rowSpan>f&&(f=u+r.rowSpan);break n}return f},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var f,e,o,u=t[i];u?(f=this._getItemType(r),u.dataType!==f&&u.dataType===n.DataType.Boolean&&f!==n.DataType.Boolean&&(u.dataType=f),r&&r.value!=null&&r.value!==''&&(e=n.xlsx.Workbook._parseExcelFormat(r),e&&u.format!==e&&e!=='General'&&(u.format=e)),r&&r.style&&(r.style.hAlign&&(o=n.xlsx.Workbook._parseHAlignToString(n.asEnum(r.style.hAlign,n.xlsx.HAlign))),u.wordWrap=u.wordWrap&&!!r.style.wordWrap),o||f!==n.DataType.Number||(o='right'),u.hAlign=o):t[i]={dataType:this._getItemType(r),format:n.xlsx.Workbook._parseExcelFormat(r),hAlign:'',wordWrap:!0}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r){try{this._resetCellStyle(t);n.grid.cellFactory.updateCell(n,i,r,t)}catch(u){return undefined}return window.getComputedStyle(t)},i._resetCellStyle=function(n){for(var t in n.style)typeof n.style[t]=='string'&&isNaN(+t)&&(n.style[t]='')},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i._getColSpan=function(n,t,i){for(var u=0,r=t.leftCol;r<=t.rightCol;r++)(!i||i(n.columns[r]))&&u++;return u},i}();i.FlexGridXlsxConverter=r})(i=t.xlsx||(t.xlsx={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))